<!DOCTYPE html>
<html lang="en">

<!-- begin::Head -->
<head>
  <base href="">
  <meta charset="utf-8" />
  <title>İltechSoft | Dashboard</title>
  <meta name="description" content="Updates and statistics">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!--begin::Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700|Roboto:300,400,500,600,700">
  <!--end::Fonts -->

  <!--begin::Page Custom Styles(used by this page) -->
  <link href="/src/assets/css/pages/login/login-6.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/pages/pricing/pricing-3.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/pages/wizard/wizard-3.css" rel="stylesheet" type="text/css" />
  <!--end::Page Custom Styles -->

  <!--begin::Page Vendors Styles(used by this page) -->
  <link href="/src/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />
  <!--end::Page Vendors Styles -->

  <!--begin::Global Theme Styles(used by all pages) -->
  <link href="/src/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
  <!--end::Global Theme Styles -->

  <!--begin::Layout Skins(used by all pages) -->
  <link href="/src/assets/css/skins/header/base/light.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/skins/header/menu/light.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/skins/brand/dark.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/skins/aside/dark.css" rel="stylesheet" type="text/css" />
  <link href="/src/assets/css/custom/style.min.css" rel="stylesheet" type="text/css" />
  <!--end::Layout Skins -->
  <link rel="shortcut icon" href="/src/assets/images/settings/favicon.ico" />

  <!-- Custom Config File -->
  <script src="/src/assets/js/custom/countries_of_world.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/cities_of_turkey.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/configBase.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/Utils.js" type="text/javascript"></script>
  <link href="/src/assets/css/custom/general.css" rel="stylesheet" type="text/css" />

  <link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.1.1/css/tabulator.min.css" rel="stylesheet">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.1.1/js/tabulator.min.js"></script>
  <script type="text/javascript" src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.3.2/jspdf.plugin.autotable.js"></script>

</head>

<!-- end::Head -->

<!-- begin::Body -->
<body>

  <div data-v-9c90884e="">
    <div data-v-9c90884e="" id="kt_subheader" class="kt-subheader kt-grid__item">
      <div data-v-9c90884e="" class="kt-container  kt-container--fluid ">
        <div data-v-9c90884e="" class="kt-subheader__main">
          <h3 data-v-9c90884e="" class="kt-subheader__title">Hepsiburada Kargo Durum</h3></div>

      </div>
    </div>
    <div data-v-9c90884e="" class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid">
      <div data-v-9c90884e="">
        <div data-v-9c90884e="" class="row product-list-loading">
          <div data-v-9c90884e="" class="col-xl-12">
            <div data-v-9c90884e="" style="padding:10px" class="kt-portlet">


              <br/>

              <div>
                <button  class="btn btn-label-brand btn-bold" id="download-xlsx">Download XLSX</button>
                <button  class="btn btn-label-brand btn-bold" id="download-pdf">Download PDF</button>
               </div>
            <br/>
              <div id="example-table"></div>

              <style>
                body {font-family: Arial, Helvetica, sans-serif;}

                /* The Modal (background) */
                .modal {
                  display: none; /* Hidden by default */
                  position: fixed; /* Stay in place */
                  /*z-index: 1;  Sit on top */
                  padding-top: 100px; /* Location of the box */
                  left: 0;
                  top: 1000;
                  width: 100%; /* Full width */
                  height: 100%; /* Full height */
                  overflow: auto; /* Enable scroll if needed */
                  background-color: rgb(0,0,0); /* Fallback color */
                  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
                }

                /* Modal Content */
                .modal-content {
                  background-color: #fefefe;
                  margin: auto;
                  padding: 20px;
                  border: 1px solid #888;
                  width: 40%;
                }

                /* The Close Button */
                .close {
                  color: #aaaaaa;
                  float: right;
                  font-size: 28px;
                  font-weight: bold;
                  align-self: flex-end;
                }

                .close:hover,
                .close:focus {
                  color: #000;
                  text-decoration: none;
                  cursor: pointer;
                }
                </style>

              <!-- The Modal -->
            <div id="myModal" class="modal">

          <!-- Modal content -->
                 <div class="modal-content" style="width: 80%;height: 700px;">
                <span class="close">&times;</span>

                  <div>

                    <h1>Kargo Detay</h1>

                  <iframe style="width: 100%;height: 600px;" src="https://selfservis.yurticikargo.com/reports/SSWDocumentDetail.aspx?DocId=176162533695" title="Kargo Detay">
                  </iframe>

                  </div>


                  </div>

               </div>


              <div data-v-9c90884e="" class="kt-portlet__body"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div data-v-9c90884e="" id="platformProductEditModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modal fade">
      <div data-v-9c90884e="" role="document" class="modal-dialog modal-xl">
        <div data-v-9c90884e="" class="modal-content">

          <div data-v-9c90884e="" class="row">
            <div data-v-9c90884e="" class="col-12 modal-loading text-center mt-5 mb-5 pt-5 pb-5">&nbsp;</div>
          </div>
          <!---->
          <!---->
          <!---->
        </div>
      </div>
    </div>
  </div>

  <!-- begin::Global Config(global config for global JS sciprts) -->
  <script>
    var KTAppOptions = {
      "colors": {
        "state": {
          "brand": "#5d78ff",
          "dark": "#282a3c",
          "light": "#ffffff",
          "primary": "#5867dd",
          "success": "#34bfa3",
          "info": "#36a3f7",
          "warning": "#ffb822",
          "danger": "#fd3995"
        },
        "base": {
          "label": [
            "#c5cbe3",
            "#a1a8c3",
            "#3d4465",
            "#3e4466"
          ],
          "shape": [
            "#f0f3ff",
            "#d9dffa",
            "#afb4d4",
            "#646c9a"
          ]
        }
      }
    };
  </script>
  <!-- end::Global Config -->

  <script type="text/javascript">

//Variables

var baseUrl = "http://localhost:8080";




    function loadFile(filename, filetype) {
      filename = filename + "?time=" + Date.now();
      if (filetype == "js") { //if filename is a external JavaScript file
        var fileref = document.createElement('script');
        fileref.setAttribute("type", "text/javascript");
        fileref.setAttribute("src", filename);
      } else if (filetype == "css") { //if filename is an external CSS file
        var fileref = document.createElement("link")
        fileref.setAttribute("rel", "stylesheet")
        fileref.setAttribute("type", "text/css")
        fileref.setAttribute("href", filename)
      }
      if (typeof fileref != "undefined")
        document.getElementsByTagName("head")[0].appendChild(fileref);
    }



//custom max min header filter
var minMaxFilterEditor = function(cell, onRendered, success, cancel, editorParams){

var end;

var container = document.createElement("span");

//create and style inputs
var start = document.createElement("input");
start.setAttribute("type", "number");
start.setAttribute("placeholder", "Min");
//start.setAttribute("min", 0);
//start.setAttribute("max", 100);
start.style.padding = "4px";
start.style.width = "50%";
start.style.boxSizing = "border-box";

start.value = cell.getValue();

function buildValues(){
    success({
        start:start.value,
        end:end.value,
    });
}

function keypress(e){
    if(e.keyCode == 13){
        buildValues();
    }

    if(e.keyCode == 27){
        cancel();
    }
}

end = start.cloneNode();
end.setAttribute("placeholder", "Max");

start.addEventListener("change", buildValues);
start.addEventListener("blur", buildValues);
start.addEventListener("keydown", keypress);

end.addEventListener("change", buildValues);
end.addEventListener("blur", buildValues);
end.addEventListener("keydown", keypress);


container.appendChild(start);
container.appendChild(end);

return container;
}

//custom max min filter function
function minMaxFilterFunction(headerValue, rowValue, rowData, filterParams){
    //headerValue - the value of the header filter element
    //rowValue - the value of the column in this row
    //rowData - the data for the row being filtered
    //filterParams - params object passed to the headerFilterFuncParams property

        if(rowValue){
            if(headerValue.start != ""){
                if(headerValue.end != ""){
                    return rowValue >= headerValue.start && rowValue <= headerValue.end;
                }else{
                    return rowValue >= headerValue.start;
                }
            }else{
                if(headerValue.end != ""){
                    return rowValue <= headerValue.end;
                }
            }
        }

    return true; //must return a boolean, true if it passes the filter.
}

//for min-max filter:  headerFilter:minMaxFilterEditor, headerFilterFunc:minMaxFilterFunction, headerFilterLiveFilter:false



function flattenData(data){
	var output = [];
	function flatternRow(row){
		var outputRow = {};
		for(var prop in row){
			if(typeof row[prop] !== "object"){
				outputRow[prop] = row[prop];
			}else{
				var flat = flattenRow(row[prop]);
				for(var flatProp in flat){
					outputRow[prop + "_" + flatProp] = flat[flatProp];
				}
			}
		}
		return outputRow;
	}
	data.forEach(function(row){
		output.push(flatternRow(row));
	});
	return output;
}

var updateIcon = function(value, data, cell, row, options){ //plain text value
    return "<i class='fa fa-folder-open'></i>"
};

var priceIcon = function(value, data, cell, row, options){ //plain text value
    return "<i class='fa fa-folder-open'></i>"
};

//tabulator script
var table = new Tabulator("#example-table", {
  rowDblClick:function(e, row){
    //e - the click event object
    //row - row component
    //window.alert(row.getData().price);


    var modal = document.getElementById("myModal");
    var btn = document.getElementById("myBtn");
    var span = document.getElementsByClassName("close")[0];
    modal.style.display = "block";
    span.onclick = function() {
    modal.style.display = "none";
}


    },
    resizableRows:true,
    selectable:true,
    tooltips:true,
    //dataTree:true,
    //dataTreeChildField:"childRows",
		height:"311px",
		layout:"fitColumns",
		placeholder:"No Data Set",
		movableColumns:true,
		layout:"fitColumns",
		columns:[
			{title:"ID", field:"id", formatter:"rownum" ,sorter:"number", width:50,headerTooltip:true, },
      {title:"Müşteri Id", field:"customerId", sorter:"string",headerFilter:"input",headerTooltip:true},
      {title:"Sipraiş Kodu", field:"orderId", sorter:"string",  tooltip:true ,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Sipariş Numarası", field:"orderNumber", sorter:"number", width:80,tooltip:true,},
      {title:"Sipariş Tarihi", field:"orderDate", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Adet", field:"quantity", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Fiyat", field:"totalPrice.amount", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Müşteri", field:"companyName", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Kargo Şirketi", field:"cargoCompanyModel.name", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},
      {title:"Durum", field:"status", sorter:"string",tooltip:true,headerTooltip:true,headerFilter:"input",headerFilterPlaceholder:"ara"},


      {title:"Kargoyu Göster" , sortable:false, formatter:updateIcon,cellClick:function(e, row){
    //e - the click event object
    //cell - cell component
    document.getElementById("barcode").value = row.getData().barcode;


    var modal = document.getElementById("myModal");
    var btn = document.getElementById("myBtn");
    var span = document.getElementsByClassName("close")[0];
  //  modal.style.display = "block";
    span.onclick = function() {
    modal.style.display = "none";
}


    //window.alert("clickedd" +  cell.getData.salePrice);
    }, }


		],
	});

	document.getElementById("download-xlsx").addEventListener("click", function(){
    table.download("xlsx", "urunler_trendyol.xlsx", {sheetName:"Urun Listesi"});
});

	document.getElementById("download-pdf").addEventListener("click", function(){
    table.download("pdf", "urunler_trendyol.pdf", {
        orientation:"portrait", //set page orientation to portrait
        title:"Urun Listesi", //add title to report
    });
});

  //qqq
var xhr = new XMLHttpRequest();

  xhr.addEventListener("readystatechange", function()  {
    if(this.readyState === 4) {
     // console.log(this.responseText);
      var resultText = xhr.responseText;


      console.log(this.responseText.replace("\"limit\":2147483647,","").replace("\"offset\":0,","").replace("\"totalCount\":1,","").replace("\"pageCount\":1,","").replace("\"items\":[{","").replace("}]}","}"));
      table.setData("[" + this.responseText.replace("\"limit\":2147483647,","").replace("\"offset\":0,","").replace("\"totalCount\":1,","").replace("\"pageCount\":1,","").replace("\"items\":[{","").replace("}]}","}") + "]");
     // table.setData(this.responseText.replace("{\"listings\":","").replace(",\"totalCount\":34,\"limit\":34,\"offset\":0}",""));

     // var objj = JSON.parse(this.responseText);

      //window.alert( "___" + objj.limit);

    //table.setData(resultText.replace("{\"listaings\":[{","").replace("}]}","}]").replace("\"totalCount\": 34, \"limit\": 34, \"offset\": 0","").replace("{\"totalElements\":3,","").replace("{\"totalElements\":4,","").replace("{\"totalElements\":5,",""));

    //table.setData(tableData222);
    //window.alert(resultText.replace("{\"totalElements\":1,\"totalPages\":1,\"page\":0,\"size\":10,\"content\":","").replace("}]}","}]"));

    }
  })



  //xhr.open("GET", "http://localhost:8080/ws_iltech_n11/ws/xmltojsonT");
  xhr.open("GET", "https://oms-external-sit.hepsiburada.com/packages/merchantid/a7ecfcdc-8a5d-4760-8f30-ae8d7ee74be4?timespan=24");
  xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
  xhr.setRequestHeader("Authorization", "Basic cHJpbXVzY2FtX2RldjpQczEyMzQ1IQ==");

  //xhr.setRequestHeader("Authorization", "Basic " + auth);

  xhr.send();





  </script>

  <!--begin::Global Theme Bundle(used by all pages) -->
  <script src="/src/assets/plugins/global/plugins.bundle.js" type="text/javascript"></script>
  <script src="/src/assets/js/scripts.bundle.js" type="text/javascript"></script>
  <!--end::Global Theme Bundle -->

  <!--begin::Page Vendors(used by this page) -->
  <script src="/src/assets/plugins/custom/fullcalendar/fullcalendar.bundle.js" type="text/javascript"></script>
  <script src="//maps.google.com/maps/api/js?key=AIzaSyBTGnKT7dt597vo9QgeQ7BFhvSRP4eiMSM" type="text/javascript"></script>
  <script src="/src/assets/plugins/custom/gmaps/gmaps.js" type="text/javascript"></script>
  <!--end::Page Vendors -->

  <!--begin::Custom Page -->
  <!--end::Custom Page -->

  <!--begin::Page Scripts(used by this page) -->

  <!-- Custom Functions -->
  <script src="/src/assets/js/sprintf.min.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/lang/tr/global.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/global.js" type="text/javascript"></script>
  <script src="/src/assets/js/custom/app.js" type="text/javascript"></script>

  <!-- Dashboard Page -->
  <script src="/src/assets/js/pages/dashboard.js" type="text/javascript"></script>

  <!-- Login Page -->
  <script src="/src/assets/js/pages/custom/login/login-general.js" type="text/javascript"></script>

  <!--Build -->
  <script src="/dist/build.js" type="text/javascript"></script>
  <!--<script type="text/javascript">loadjscssfile("/dist/build.js", "js");</script>-->

  <!-- One Signal -->
  <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-153396545-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-153396545-1');
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->

  
</body>
<!-- end::Body -->
</html>
